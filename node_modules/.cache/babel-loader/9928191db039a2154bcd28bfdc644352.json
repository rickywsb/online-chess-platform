{"ast":null,"code":"var _jsxFileName = \"/Users/gucenzhang/web-chess/online-chess-react-platform/src/pages/AdminPage.js\";\nimport React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { fetchUsers, updateUserRole } from '../api/admin';\nconst AdminPage = () => {\n  const navigate = useNavigate();\n  const [users, setUsers] = useState([]);\n  useEffect(() => {\n    const role = localStorage.getItem('userRole');\n    console.log('User role:', role); // 调试输出\n\n    if (role !== 'admin') {\n      console.log('Redirecting to home, not an admin'); // 调试输出\n\n      navigate('/');\n    } else {\n      loadUsers();\n    }\n  }, [navigate]);\n  const loadUsers = async () => {\n    try {\n      const fetchedUsers = await fetchUsers();\n      setUsers(fetchedUsers);\n    } catch (error) {\n      console.error('Failed to fetch users:', error);\n    }\n  };\n  const handleChangeRole = async (userId, newRole) => {\n    try {\n      await updateUserRole(userId, newRole);\n      loadUsers(); // 重新加载用户列表以反映更改\n    } catch (error) {\n      console.error('Failed to update user role:', error);\n    }\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 7\n    }\n  }, \"Admin Page\"), /*#__PURE__*/React.createElement(\"table\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"thead\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 13\n    }\n  }, \"Username\"), /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 13\n    }\n  }, \"Role\"), /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 13\n    }\n  }, \"Actions\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 9\n    }\n  }, users.map(user => /*#__PURE__*/React.createElement(\"tr\", {\n    key: user._id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 15\n    }\n  }, user.username), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 15\n    }\n  }, user.role), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"select\", {\n    value: user.role,\n    onChange: e => handleChangeRole(user._id, e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    value: \"student\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 19\n    }\n  }, \"Student\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"instructor\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 19\n    }\n  }, \"Instructor\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"admin\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 19\n    }\n  }, \"Admin\"))))))));\n};\nexport default AdminPage;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","fetchUsers","updateUserRole","AdminPage","navigate","users","setUsers","role","localStorage","getItem","console","log","loadUsers","fetchedUsers","error","handleChangeRole","userId","newRole","createElement","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","map","user","key","_id","username","value","onChange","e","target"],"sources":["/Users/gucenzhang/web-chess/online-chess-react-platform/src/pages/AdminPage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { fetchUsers, updateUserRole } from '../api/admin';\n\nconst AdminPage = () => {\n  const navigate = useNavigate();\n  const [users, setUsers] = useState([]);\n\n  useEffect(() => {\n    const role = localStorage.getItem('userRole');\n    console.log('User role:', role); // 调试输出\n\n    if (role !== 'admin') {\n        console.log('Redirecting to home, not an admin'); // 调试输出\n\n      navigate('/');\n    } else {\n      loadUsers();\n    }\n  }, [navigate]);\n\n  const loadUsers = async () => {\n    try {\n      const fetchedUsers = await fetchUsers();\n      setUsers(fetchedUsers);\n    } catch (error) {\n      console.error('Failed to fetch users:', error);\n    }\n  };\n\n  const handleChangeRole = async (userId, newRole) => {\n    try {\n      await updateUserRole(userId, newRole);\n      loadUsers(); // 重新加载用户列表以反映更改\n    } catch (error) {\n      console.error('Failed to update user role:', error);\n    }\n  };\n\n  return (\n    <div>\n      <h1>Admin Page</h1>\n      <table>\n        <thead>\n          <tr>\n            <th>Username</th>\n            <th>Role</th>\n            <th>Actions</th>\n          </tr>\n        </thead>\n        <tbody>\n          {users.map(user => (\n            <tr key={user._id}>\n              <td>{user.username}</td>\n              <td>{user.role}</td>\n              <td>\n                <select value={user.role} onChange={(e) => handleChangeRole(user._id, e.target.value)}>\n                  <option value=\"student\">Student</option>\n                  <option value=\"instructor\">Instructor</option>\n                  <option value=\"admin\">Admin</option>\n                </select>\n              </td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n    </div>\n  );\n};\n\nexport default AdminPage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}