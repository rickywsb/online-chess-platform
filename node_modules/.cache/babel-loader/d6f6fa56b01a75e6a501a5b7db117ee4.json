{"ast":null,"code":"var _jsxFileName = \"/Users/gucenzhang/web-chess/online-chess-react-platform/src/pages/LoginPage.js\";\nimport React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { loginUser } from '../api/auth';\nimport { useAuth } from '../contexts/AuthContext'; // Import useAuth\n\nconst LoginPage = () => {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const navigate = useNavigate();\n  const {\n    login\n  } = useAuth(); // Destructure login function from useAuth\n\n  const handleLogin = async e => {\n    e.preventDefault();\n    try {\n      const data = await loginUser(email, password);\n      localStorage.setItem('token', data.token);\n      localStorage.setItem('userId', data.result._id);\n      localStorage.setItem('userRole', data.result.role); // 存储用户角色\n\n      login(data.result); // Call login from AuthContext with the user data\n\n      navigate('/'); // Navigate to home page after login\n    } catch (error) {\n      console.error('Login failed:', error);\n      // Handle login error\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 30,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleLogin,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 31,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"email\",\n    value: email,\n    onChange: e => setEmail(e.target.value),\n    placeholder: \"Email\",\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 32,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"password\",\n    value: password,\n    onChange: e => setPassword(e.target.value),\n    placeholder: \"Password\",\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 9\n    }\n  }, \"Login\")));\n};\nexport default LoginPage;","map":{"version":3,"names":["React","useState","useNavigate","loginUser","useAuth","LoginPage","email","setEmail","password","setPassword","navigate","login","handleLogin","e","preventDefault","data","localStorage","setItem","token","result","_id","role","error","console","createElement","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","type","value","onChange","target","placeholder","required"],"sources":["/Users/gucenzhang/web-chess/online-chess-react-platform/src/pages/LoginPage.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { loginUser } from '../api/auth';\nimport { useAuth } from '../contexts/AuthContext'; // Import useAuth\n\nconst LoginPage = () => {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const navigate = useNavigate();\n  const { login } = useAuth(); // Destructure login function from useAuth\n\n  const handleLogin = async (e) => {\n    e.preventDefault();\n    try {\n      const data = await loginUser(email, password);\n      localStorage.setItem('token', data.token);\n      localStorage.setItem('userId', data.result._id);\n      localStorage.setItem('userRole', data.result.role); // 存储用户角色\n\n      login(data.result); // Call login from AuthContext with the user data\n\n      navigate('/'); // Navigate to home page after login\n    } catch (error) {\n      console.error('Login failed:', error);\n      // Handle login error\n    }\n  };\n\n  return (\n    <div>\n      <form onSubmit={handleLogin}>\n        <input\n          type=\"email\"\n          value={email}\n          onChange={(e) => setEmail(e.target.value)}\n          placeholder=\"Email\"\n          required\n        />\n        <input\n          type=\"password\"\n          value={password}\n          onChange={(e) => setPassword(e.target.value)}\n          placeholder=\"Password\"\n          required\n        />\n        <button type=\"submit\">Login</button>\n      </form>\n    </div>\n  );\n};\n\nexport default LoginPage;\n"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,QAAQ,QAAQ,OAAO;AACvC,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,SAAS,QAAQ,aAAa;AACvC,SAASC,OAAO,QAAQ,yBAAyB,CAAC,CAAC;;AAEnD,MAAMC,SAAS,GAAGA,CAAA,KAAM;EACtB,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGN,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAACO,QAAQ,EAAEC,WAAW,CAAC,GAAGR,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAMS,QAAQ,GAAGR,WAAW,CAAC,CAAC;EAC9B,MAAM;IAAES;EAAM,CAAC,GAAGP,OAAO,CAAC,CAAC,CAAC,CAAC;;EAE7B,MAAMQ,WAAW,GAAG,MAAOC,CAAC,IAAK;IAC/BA,CAAC,CAACC,cAAc,CAAC,CAAC;IAClB,IAAI;MACF,MAAMC,IAAI,GAAG,MAAMZ,SAAS,CAACG,KAAK,EAAEE,QAAQ,CAAC;MAC7CQ,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEF,IAAI,CAACG,KAAK,CAAC;MACzCF,YAAY,CAACC,OAAO,CAAC,QAAQ,EAAEF,IAAI,CAACI,MAAM,CAACC,GAAG,CAAC;MAC/CJ,YAAY,CAACC,OAAO,CAAC,UAAU,EAAEF,IAAI,CAACI,MAAM,CAACE,IAAI,CAAC,CAAC,CAAC;;MAEpDV,KAAK,CAACI,IAAI,CAACI,MAAM,CAAC,CAAC,CAAC;;MAEpBT,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC;IACjB,CAAC,CAAC,OAAOY,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,eAAe,EAAEA,KAAK,CAAC;MACrC;IACF;EACF,CAAC;;EAED,oBACEtB,KAAA,CAAAwB,aAAA;IAAAC,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBACE9B,KAAA,CAAAwB,aAAA;IAAMO,QAAQ,EAAEnB,WAAY;IAAAa,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBAC1B9B,KAAA,CAAAwB,aAAA;IACEQ,IAAI,EAAC,OAAO;IACZC,KAAK,EAAE3B,KAAM;IACb4B,QAAQ,EAAGrB,CAAC,IAAKN,QAAQ,CAACM,CAAC,CAACsB,MAAM,CAACF,KAAK,CAAE;IAC1CG,WAAW,EAAC,OAAO;IACnBC,QAAQ;IAAAZ,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,CACT,CAAC,eACF9B,KAAA,CAAAwB,aAAA;IACEQ,IAAI,EAAC,UAAU;IACfC,KAAK,EAAEzB,QAAS;IAChB0B,QAAQ,EAAGrB,CAAC,IAAKJ,WAAW,CAACI,CAAC,CAACsB,MAAM,CAACF,KAAK,CAAE;IAC7CG,WAAW,EAAC,UAAU;IACtBC,QAAQ;IAAAZ,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,CACT,CAAC,eACF9B,KAAA,CAAAwB,aAAA;IAAQQ,IAAI,EAAC,QAAQ;IAAAP,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GAAC,OAAa,CAC/B,CACH,CAAC;AAEV,CAAC;AAED,eAAezB,SAAS"},"metadata":{},"sourceType":"module"}