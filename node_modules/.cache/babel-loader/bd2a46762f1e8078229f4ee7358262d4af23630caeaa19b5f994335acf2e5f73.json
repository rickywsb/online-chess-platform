{"ast":null,"code":"var _jsxFileName = \"/Users/levi/Desktop/chess/online-chess-react-platform/src/components/Modules/ModuleList.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport ModuleCard from './ModuleCard';\nimport ModuleForm from './ModuleForm'; // Ensure you have a ModuleForm component\nimport { useAuth } from '../../contexts/AuthContext'; // 引入 useAuth 钩子\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ModuleList = ({\n  courseId\n}) => {\n  _s();\n  const [modules, setModules] = useState([]);\n  const [showModuleForm, setShowModuleForm] = useState(false);\n  const [editingModule, setEditingModule] = useState(null); // State to hold the module being edited\n  const {\n    user\n  } = useAuth(); // 使用 useAuth 钩子获取用户数据\n  const userRole = user === null || user === void 0 ? void 0 : user.role; // 直接访问用户角色\n  console.log(\"Current user role:\", userRole);\n  useEffect(() => {\n    const fetchModules = async () => {\n      try {\n        const response = await axios.get(`/api/modules/course/${courseId}`);\n        setModules(response.data);\n      } catch (error) {\n        console.error('Error fetching modules:', error);\n      }\n    };\n    fetchModules();\n  }, [courseId]);\n  const addModuleToList = newModule => {\n    setModules(prevModules => [...prevModules, newModule]);\n  };\n  const updateModuleInList = updatedModule => {\n    setModules(prevModules => prevModules.map(module => module._id === updatedModule._id ? updatedModule : module));\n  };\n  const deleteModuleFromList = moduleId => {\n    setModules(prevModules => prevModules.filter(module => module._id !== moduleId));\n  };\n  const handleModuleAddition = moduleData => {\n    addModuleToList(moduleData);\n    setShowModuleForm(false); // Close the form after addition\n  };\n\n  const handleModuleUpdate = updatedModule => {\n    updateModuleInList(updatedModule);\n    setEditingModule(null); // Reset the editing state\n  };\n\n  const handleEdit = module => {\n    setEditingModule(module); // Set the module to be edited\n    setShowModuleForm(true); // Show the form for editing\n  };\n\n  const handleDelete = async moduleId => {\n    const confirmDelete = window.confirm('Are you sure you want to delete this module?');\n    if (confirmDelete) {\n      try {\n        await axios.delete(`/api/modules/${moduleId}`);\n        deleteModuleFromList(moduleId);\n      } catch (error) {\n        console.error('Error deleting module:', error);\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"module-list\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Modules\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this), (userRole === 'admin' || userRole === 'instructor') && /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => {\n        setShowModuleForm(true);\n        setEditingModule(null);\n      },\n      children: \"Add Module\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 13\n    }, this), showModuleForm && /*#__PURE__*/_jsxDEV(ModuleForm, {\n      courseId: courseId,\n      moduleData: editingModule,\n      onModuleAddition: handleModuleAddition,\n      onModuleUpdate: handleModuleUpdate\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 9\n    }, this), modules.map(module => /*#__PURE__*/_jsxDEV(ModuleCard, {\n      module: module,\n      onEdit: () => handleEdit(module),\n      onDelete: () => handleDelete(module._id)\n    }, module._id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 9\n    }, this))]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 5\n  }, this);\n};\n_s(ModuleList, \"BVfEzJmEgEdf/G1cq1ab5WXDU4E=\", false, function () {\n  return [useAuth];\n});\n_c = ModuleList;\nexport default ModuleList;\nvar _c;\n$RefreshReg$(_c, \"ModuleList\");","map":{"version":3,"names":["React","useState","useEffect","axios","ModuleCard","ModuleForm","useAuth","jsxDEV","_jsxDEV","ModuleList","courseId","_s","modules","setModules","showModuleForm","setShowModuleForm","editingModule","setEditingModule","user","userRole","role","console","log","fetchModules","response","get","data","error","addModuleToList","newModule","prevModules","updateModuleInList","updatedModule","map","module","_id","deleteModuleFromList","moduleId","filter","handleModuleAddition","moduleData","handleModuleUpdate","handleEdit","handleDelete","confirmDelete","window","confirm","delete","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","onModuleAddition","onModuleUpdate","onEdit","onDelete","_c","$RefreshReg$"],"sources":["/Users/levi/Desktop/chess/online-chess-react-platform/src/components/Modules/ModuleList.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport ModuleCard from './ModuleCard';\nimport ModuleForm from './ModuleForm'; // Ensure you have a ModuleForm component\nimport { useAuth } from '../../contexts/AuthContext'; // 引入 useAuth 钩子\n\nconst ModuleList = ({ courseId }) => {\n  const [modules, setModules] = useState([]);\n  const [showModuleForm, setShowModuleForm] = useState(false);\n  const [editingModule, setEditingModule] = useState(null); // State to hold the module being edited\n  const { user } = useAuth(); // 使用 useAuth 钩子获取用户数据\n  const userRole = user?.role; // 直接访问用户角色\n  console.log(\"Current user role:\", userRole);\n\n  useEffect(() => {\n    const fetchModules = async () => {\n      try {\n        const response = await axios.get(`/api/modules/course/${courseId}`);\n        setModules(response.data);\n      } catch (error) {\n        console.error('Error fetching modules:', error);\n      }\n    };\n\n    fetchModules();\n  }, [courseId]);\n\n  const addModuleToList = (newModule) => {\n    setModules(prevModules => [...prevModules, newModule]);\n  };\n\n  const updateModuleInList = (updatedModule) => {\n    setModules(prevModules => prevModules.map(module => \n      module._id === updatedModule._id ? updatedModule : module\n    ));\n  };\n\n  const deleteModuleFromList = (moduleId) => {\n    setModules(prevModules => prevModules.filter(module => module._id !== moduleId));\n  };\n\n  const handleModuleAddition = (moduleData) => {\n    addModuleToList(moduleData);\n    setShowModuleForm(false); // Close the form after addition\n  };\n\n  const handleModuleUpdate = (updatedModule) => {\n    updateModuleInList(updatedModule);\n    setEditingModule(null); // Reset the editing state\n  };\n\n  const handleEdit = (module) => {\n    setEditingModule(module); // Set the module to be edited\n    setShowModuleForm(true); // Show the form for editing\n  };\n\n  const handleDelete = async (moduleId) => {\n    const confirmDelete = window.confirm('Are you sure you want to delete this module?');\n    if (confirmDelete) {\n      try {\n        await axios.delete(`/api/modules/${moduleId}`);\n        deleteModuleFromList(moduleId);\n      } catch (error) {\n        console.error('Error deleting module:', error);\n      }\n    }\n  };\n\n  return (\n    <div className=\"module-list\">\n      <h2>Modules</h2>\n            {/* 仅当用户是管理员或讲师时显示添加模块按钮 */}\n      {(userRole === 'admin' || userRole === 'instructor') && (\n            <button onClick={() => { setShowModuleForm(true); setEditingModule(null); }}>Add Module</button>\n      )}\n\n      {showModuleForm && (\n        <ModuleForm\n          courseId={courseId}\n          moduleData={editingModule}\n          onModuleAddition={handleModuleAddition}\n          onModuleUpdate={handleModuleUpdate}\n        />\n      )}\n      {modules.map(module => (\n        <ModuleCard\n          key={module._id}\n          module={module}\n          onEdit={() => handleEdit(module)}\n          onDelete={() => handleDelete(module._id)}\n        />\n      ))}\n    </div>\n  );\n};\n\nexport default ModuleList;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}